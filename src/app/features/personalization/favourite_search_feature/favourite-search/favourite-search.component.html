<div
  class="max-w-5xl mx-auto bg-white rounded-sm shadow mx-6 ml-3"
  *transloco="let t"
>
  <!-- Header -->
  <div
    class="flex justify-between items-center bg-[#546e7a] text-white text-sm px-4 py-2 rounded-t-lg"
  >
    <div class="flex items-center space-x-2">
      <i class="icon-heart-o"></i>
      <span class="font-semibold text-lg text-sm">{{
        t("favourite.title")
      }}</span>
    </div>
    <a
      href="#"
      class="text-green-300 hover:text-green-200 flex items-center space-x-1"
    >
      <img
        src="https://mybdjobs.bdjobs.com/mybdjobs/images/feedback-arrow.svg"
        alt=""
      />
      <a href="https://jobs.bdjobs.com/feedback.asp?sf=1">{{
        t("favourite.feedback")
      }}</a>
    </a>
  </div>

  <!-- Instructions -->
  <div class="mt-4 text-gray-800 p-5 text-sm whitespace-normal break-words">
    <p>{{ t("favourite.instruction_1") }}</p>
    <p>{{ t("favourite.instruction_2") }}</p>
    <ol class="list-decimal list-inside mt-3 space-y-1 pl-3">
      <li>{{ t("favourite.step_1") }}</li>
      <li>{{ t("favourite.step_2") }}</li>
      <li>{{ t("favourite.step_3") }}</li>
      <li>
        @if (currentLang !== 'bn') {
        {{ t("favourite.step_4")
        }}<a
          href="https://mybdjobs.bdjobs.com/mybdjobs/sms/sms-setting.asp"
          class="text-blue-800 p-1"
        >
          <i class="icon-sms-setting"></i>{{ t("favourite.sms_settings") }} </a
        >. } @else {
        <a
          href="https://mybdjobs.bdjobs.com/mybdjobs/sms/sms-setting.asp"
          class="text-blue-800 p-1"
        >
          <i class="icon-sms-setting"></i>{{ t("favourite.sms_settings") }} </a
        >{{ t("favourite.step_4") }}
        }
      </li>
    </ol>
  </div>

  <!-- Summary & Actions -->
  <div
    class="flex justify-between items-center pl-6 pr-6 text-sm whitespace-normal break-words"
  >
    <div class="text-[#008020] font-semibold">
      {{ t("favourite.total_count") }}
      <span class="bg-[#008020] text-white px-2 py-0.5 rounded font-xl">{{
        total
      }}</span>
    </div>
    <div class="flex justify-end space-x-4 pr-3">
      <!-- Added flex justify-end -->
      <a href="#" class="flex items-center space-x-1">
        <i class="icon-purchase-trolly"></i>
        <span>{{ t("favourite.buy_sms") }}</span>
      </a>
      <a href="#" class="flex items-center space-x-1 text-blue-800">
        <i class="icon-sms-setting"></i>
        <span>{{ t("favourite.sms_settings") }}</span>
      </a>
    </div>
  </div>

  <!-- Table -->
  <div class="mt-4 pl-6 pr-6">
    <table class="w-full bg-white border-separate border-spacing-y-4">
      <thead class="bg-gray-200 text-left text-gray-700">
        <tr>
          <th class="px-1.5 text-center text-sm whitespace-normal break-words">
            {{ t("favourite.sl") }}
          </th>
          <th class="px-1.5 text-sm whitespace-normal break-words">
            {{ t("favourite.name") }}
          </th>
          <th class="px-1.5 text-center text-sm whitespace-normal break-words">
            {{ t("favourite.jobs") }}
          </th>
          <th class="px-1.5 text-center text-sm whitespace-normal break-words">
            {{ t("favourite.alert") }}
          </th>
          <th class="px-1.5 text-center text-sm whitespace-normal break-words">
            {{ t("favourite.action") }}
          </th>
        </tr>
      </thead>
      <tbody>
        @for (item of favorites; track item; let i = $index) {
        <tr
          class="border-t bg-[#f5f5f5] rounded-lg shadow m-3 text-left text-sm break-words"
        >
          <td class="px-4 py-3 text-gray-600">{{ i + 1 }}</td>
          <td class="px-4 py-3">
            <a href="#" class="text-blue-600 hover:underline font-medium">{{
              item.filterName
            }}</a>
            <div class="text-gray-500 text-sm mt-1 flex items-center space-x-1">
              <span class="font-bold">{{ t("favourite.modified") }}</span>
              <i class="icon-calendar icon-padding"></i>
              <span class="font-bold">{{ item.savedOn }}</span>
            </div>
          </td>
          <td class="px-4 py-3">
            <a href="#" class="text-blue-600 font-medium">{{
              item.availableJobs
            }}</a>
          </td>
          <td class="px-4 py-3">
            @if (item.smsNotification == "True") {
            <button
              (click)="toggleSubscription(item)"
              class="bg-gray-300 text-black px-3 py-1 rounded flex items-center space-x-1 text-sm whitespace-normal break-words"
            >
              <i class="icon-Bell-not"></i>
              <span>{{ t("favourite.unsubscribe") }}</span>
            </button>
            } @else {
            <button
              (click)="toggleSubscription(item)"
              class="bg-[#008020] text-white px-3 py-1 rounded flex items-center space-x-1"
            >
              <i class="icon-bell"></i>
              <span>{{ t("favourite.subscribe") }}</span>
            </button>
            }
          </td>
          <td class="px-4 py-3">
            <button
              class="bg-gray-500 text-white px-3 py-1 rounded flex items-center space-x-1 hover:bg-red-800 transition-colors duration-150"
              (click)="openDeleteModal(item)"
            >
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                <path
                  d="M6 2a1 1 0 00-1 1v1H3a1 1 0 100 2h14a1 1 0 100-2h-2V3a1 1 0 00-1-1H6zM5 6v10a2 2 0 002 2h6a2 2 0 002-2V6H5z"
                />
              </svg>
              <span>{{ t("favourite.delete") }}</span>
            </button>
          </td>
        </tr>
        }
        <!-- subscribe Modal -->
        @if (isModalOpen) {
        <div
          class="fixed inset-0 bg-black bg-opacity-50 flex items-start md:items-center justify-center p-4 z-50"
          (click)="closeModal()"
        >
          <div
            class="bg-white rounded-lg overflow-hidden w-full md:w-[550px] md:h-[320px] shadow-lg transform transition-all duration-300"
            [class.translate-y-[-50px]]="!isModalOpen"
            [class.opacity-0]="!isModalOpen"
            [class.translate-y-0]="isModalOpen"
            [class.opacity-100]="isModalOpen"
            (click)="$event.stopPropagation()"
          >
            <div
              class="bg-[#1a2161] text-white p-6 relative flex flex-col items-center justify-center"
            >
              <button
                (click)="closeModal()"
                class="absolute top-4 right-4 text-sm text-grey-300 font-bold bg-white/[0.1] opacity-50 rounded-full w-8 h-8 flex items-center justify-center hover:bg-white/[0.3]"
              >
                X
              </button>

              <div class="rounded-full p-4 shadow-md bg-white/[0.2]">
                <img
                  src="https://mybdjobs.bdjobs.com//mybdjobs/images/sms-notification.png"
                  alt="iamge"
                  class="w-[45px] h-[40px]"
                />
              </div>
              <h2 class="mt-4 text-xl font-bold">Favorite Search Job Alert</h2>
            </div>

            <div class="p-10 text-center text-black-700">
              <p>
                You have successfully subscribed to get
                <span class="font-bold"> SMS Job Alert</span>. for this search.
                You will get instant job notifications relevant to your
                subscribed
                <span class="font-bold">Favorite Search.</span>
              </p>
            </div>
          </div>
        </div>
        } @if (isDeleteModalOpen) {
        <!-- backdrop -->
        <div
          class="fixed inset-0 bg-black bg-opacity-50 flex items-start md:items-center justify-center p-4 z-50 transition-opacity duration-300"
          (click)="closeDeleteModal()"
        >
          <!-- panel -->
          <div
            @modalAnimation
            class="bg-white rounded-lg overflow-hidden w-full max-w-md shadow-lg md:w-[650px] md:h-[200px]"
            (click)="$event.stopPropagation()"
          >
            <!-- header -->
            <div class="p-6 text-2xl flex items-center space-x-3">
              <i class="icon-trush-can text-3xl text-red-600"></i>
              <h2 class="font-semibold">Delete!</h2>
            </div>

            <!-- body -->
            <div class="px-6 pb-6">
              <p class="text-black-700">
                Are you sure, you want to delete this record?
              </p>

              <!-- actions -->
              <div class="mt-6 flex justify-end space-x-4">
                <button class="font-medium" (click)="closeDeleteModal()">
                  CANCEL
                </button>
                <button
                  class="bg-red-600 font-bold text-white px-4 py-2 rounded"
                  (click)="confirmDelete()"
                >
                  YES, DELETE
                </button>
              </div>
            </div>
          </div>
        </div>
        }
      </tbody>
    </table>
  </div>
</div>
@if (showUnsubscribeToast) {
<div
  @toastAnimation
  class="fixed bottom-0 inset-x-0 bg-green-100 text-green-800 flex items-center justify-center space-x-2 py-2 z-50 shadow-md"
>
  <i
    class="icon-check-sign text-sm text-white bg-green-500 rounded-full p-1 inline-block"
  ></i>
  <span>You have successfully unsubscribed to this search.</span>
  <button
    (click)="closeToast()"
    class="ml-auto pr-4 text-lg text-grey-300 font-bold hover:text-green-600"
  >
    Ã—
  </button>
</div>
}
