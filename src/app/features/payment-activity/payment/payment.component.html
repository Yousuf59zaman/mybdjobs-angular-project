<div class=" w-full flex flex-col justify-center items-center">
  <div class="rounded-none md:rounded-lg border-none h-[84vh] md:h-[500px] relative bg-white md:border px-4 md:px-6 border-[#E4E7EC] w-full md:w-[600px] md:max-w-[600px] text-primary-900 shadow">
    <div class="mt-3 w-full text-start">
      <h2 class="text-xl font-semibold">Payment Details</h2>
    </div>
    
    <div class="h-[64vh] md:h-[360px] overflow-y-auto pe-2 [&::-webkit-scrollbar]:w-1.5 [&::-webkit-scrollbar-track]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:bg-gray-300">
      <div class="mt-6 w-full">
        <table class="table w-full">
          <tr class="grid grid-cols-4 text-[#595959] text-xs">
            <td
              class="text-start"
              [ngClass]="isAllowedUnitPurchase() ? 'col-span-2' : 'col-span-3'">
              Description
            </td>
            <td
              class="col-span-1 text-center"
              [ngClass]="{
                'hidden': !isAllowedUnitPurchase()
              }">
              Unit
            </td>
            <td class="col-span-1 text-end">Amount</td>
          </tr>
          <tr class="grid grid-cols-4 text-sm font-semibold">
            <td
              class="text-start"
              [ngClass]="isAllowedUnitPurchase() ? 'col-span-2' : 'col-span-3'">
              {{ packageTitle() }}
            </td>
            <td
              class="col-span-1 text-center"
              [ngClass]="{
                'hidden': !isAllowedUnitPurchase()
              }">
              {{ packageUnitCount()>9 ? packageUnitCount() : '0'+packageUnitCount() }}
            </td>
            <td class="col-span-1 text-end">৳{{ packageAmount() }}/-</td>
          </tr>
        </table>
        <span class="text-start italic py-1.5 flex items-center text-[10px]">
          Duration:
          <span class="font-semibold">{{ packageDuration() }} days</span>
        </span>
        <div class="w-full py-3.5 my-2 text-xs border-t-[1.5px] border-b-[1.5px] border-dashed border-[#c2c2c2] flex justify-between items-center">
          <span class="text-[#595959]">Sub Total</span>
          <span class="font-semibold">৳{{ subTotalAmount() }}/-</span>
        </div>
      </div>
      
      <div class="mt-6 w-full">
        <input
          type="text"
          class="w-full rounded border border-[#B32D7D] text-xs px-3.5 py-2 focus:ring-0"
          placeholder="Enter Promo Code"
          appNumericOnly
          [isDecimalAllowed]="false"
          [isNumericOnly]="false"
          [formControl]="controlPromo"
        >
        <div class="w-full text-end">
          <span
            class="underline cursor-pointer text-[11px] text-[#B32D7D]"
            (click)="onClickAllPromo()">
            See all codes
          </span>
        </div>
      </div>
      
      <div class="mt-3 w-full">
        <div class="py-3.5 border-t-[1.5px] border-b-[1.5px] border-dashed border-[#c2c2c2] flex flex-col gap-1 w-full">
          <div class="flex items-center justify-between">
            <span class="text-[#595959] text-xs">Available Points</span>
            <p class="text-[9px] text-primary-700 font-medium rounded-[25px] p-[3px] border border-[#E4E7EC] flex items-center gap-1">
              <span class="icon-credit-point-system"></span>
              {{ pointRedeemable() }}
            </p>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-[#595959] text-xs">Redeem</span>
            <p class="text-xs font-semibold text-primary-900">-৳ {{ pointRedeemAmount() }}/-</p>
          </div>
        </div>
      </div>
      
      <div class="my-4 w-full">
        <div class="flex justify-between items-center font-bold text-lg">
          <span class="text-primary-700">Total</span>
          <span class="text-[#008020]">৳{{ payableTotalAmount() }}/-</span>
        </div>
      </div>
      
      <hr class="my-4 w-full border border-[#c2c2c2]">

      <div class="my-4 w-full text-start">
        <h2 class="text-xl font-semibold">Choose a payment method</h2>
      </div>

      <div class="my-4 w-full">
        <div class="w-full grid grid-cols-3 gap-3.5">
          <div
            class="border rounded-md py-3 text-center my-1.5 text-xs cursor-pointer relative"
            [ngClass]="selectedPaymentMethod() === 'bkash' ? 'border-[#008020]' : 'border-[#DDD]'"
            (click)="onClickPaymentMethod(1)"
          >
            <span
              class="absolute top-1 right-1 icon-check-sign text-white bg-[#008020] rounded-full text-[5px] p-0.5 text-center"
              [ngClass]="{'hidden' : selectedPaymentMethod() !== 'bkash'}"></span>
            Bkash
          </div>
          <div
            class="border rounded-md py-3 text-center my-1.5 text-xs cursor-pointer relative"
            [ngClass]="selectedPaymentMethod() === 'card' ? 'border-[#008020]' : 'border-[#DDD]'"
            (click)="onClickPaymentMethod(2)"
          >
            <span
              class="absolute top-1 right-1 icon-check-sign text-white bg-[#008020] rounded-full text-[5px] p-0.5 text-center"
              [ngClass]="{'hidden' : selectedPaymentMethod() !== 'card'}"></span>
            Cards
          </div>
          <div
            class="border rounded-md py-3 my-1.5 text-center text-xs cursor-pointer relative"
            [ngClass]="selectedPaymentMethod() === 'other'
              ? 'border-[#008020] mb-0 pb-[18px] rounded-b-none border-b-white'
              : 'border-[#DDD]'
            "
            (click)="onClickPaymentMethod(3)">
            <span
              class="absolute left-0 -bottom-0.5 md:-bottom-px border border-white w-full"
              [ngClass]="{'hidden': selectedPaymentMethod() !== 'other'}"
            ></span>
            Others
          </div>
        </div>
        <div
          class="w-full border border-[#008020] rounded-b-md rounded-tl-md"
          [ngClass]="{'hidden': selectedPaymentMethod() !== 'other'}">
          <div class="p-3 grid grid-cols-3 gap-2.5">
            @for(method of otherPaymentMethods(); track $index) {
              <div
                class="col-span-1 border rounded-md py-1.5 text-center text-xs cursor-pointer relative"
                [ngClass]="method.isMethodSelected
                  ? 'border-[#008020]'
                  : 'border-[#DDD]'
                "
                (click)="onClickOtherPaymentMethod(method.methodId)"
              >
                <span
                  class="absolute top-1 right-1 icon-check-sign text-white bg-[#008020] rounded-full text-[5px] p-0.5 text-center"
                  [ngClass]="{'hidden' : !method.isMethodSelected}"
                ></span>
                {{ method.methodTitle }}
              </div>
            }
          </div>
        </div>
      </div>

      <div class="my-4 w-full">
        <div
          class="w-full border border-[#FBF6DE] bg-[#FFFBEC] rounded-md py-2 px-3 transition-transform duration-300 ease-in-out cursor-pointer"
          (click)="toggle()">
          <div class="flex items-center justify-between">
            <div class="flex items-center gap-3">
              <span class="icon-warning text-[#F57F17] text-base"></span>
              <span class="text-base font-semibold">Read before proceed</span>
            </div>
            <div class="">
              <span class="text-sm icon-angle-down" [ngClass]="{'hidden': isOpen()}"></span>
              <span class="text-sm icon-angle-up" [ngClass]="{'hidden': !isOpen()}"></span>
            </div>
          </div>
          <div
            class="ps-7 w-full"
            [ngClass]="{'hidden': !isOpen()}">
            <span class="w-full text-xs">
              If you upgrade or repurchase, your remaining balance will be added to your newly purchased package (first month only).
            </span>
          </div>
        </div>
      </div>
    </div>

    <div class="absolute bottom-0 left-0 z-10 bg-white pt-2 w-full rounded-none md:rounded-b-lg">
      <div class="px-4 md:px-6 mb-2.5">
        <button
          class="w-full rounded-lg bg-[#02711E] text-white py-[14px] font-semibold text-sm flex items-center justify-center"
          (click)="onClickConfirmPaynent()">
          <span>Pay ৳{{ payableTotalAmount() }}/-</span>
          <span class="icon-angle-right-long text-xs"></span>
        </button>
      </div>
      <div class="text-center mb-1.5 pb-1 text-xs flex justify-center items-center gap-1 text-[10px]">
        <span class="">Need Help? Call</span>
        <span class="text-[#F33838] font-semibold">+8801897627858</span>
      </div>
    </div>
  </div>
</div>